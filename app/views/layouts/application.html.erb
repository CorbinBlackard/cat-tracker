<!DOCTYPE html>
<html>
	<head>
		<title><%= content_for(:title) || "Cat Tracker" %></title>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<%= csrf_meta_tags %>
		<%= csp_meta_tag %>

		<%= yield :head %>

		<link rel="icon" href="/icon.png" type="image/png">
		<link rel="icon" href="/icon.svg" type="image/svg+xml">
		<link rel="apple-touch-icon" href="/icon.png">

		<%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
		<%= javascript_importmap_tags %>
		
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	</head>

	<body class="body" style="padding-bottom: 70px;">
		<%= render partial: "/layouts/header" %>

		<main>
			<% if current_page?(root_path) %>
				<%# HOMEPAGE: Flex layout with sidebar %>
				<div class="homepage-container d-flex">
					<%= render partial: "/layouts/missing"%>
					<div class="main-content-column">
						<%= yield %>
					</div>
				</div>
			<% else %>
				<%# OTHER PAGES: Normal container %>
				<div class="container">
					<%= yield %>
				</div>
			<% end %>
		</main>
		
		<%= render partial: "/layouts/footer" %>
		
		<script>
			document.addEventListener("turbo:before-render", () => {
				localStorage.setItem("scrollPosition", window.scrollY);
			});

			document.addEventListener("turbo:render", () => {
				const scrollY = localStorage.getItem("scrollPosition");
				if (scrollY !== null) {
					window.scrollTo({
						top: parseInt(scrollY),
						behavior: 'smooth'
					});
					localStorage.removeItem("scrollPosition");
				}
			});
		</script>
	</body>
</html>